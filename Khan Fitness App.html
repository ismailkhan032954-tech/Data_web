<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Your own AI Fitnees Club </title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#06b6d4;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{margin:0;background:linear-gradient(180deg,#071428 0%, #071826 60%);color:#e6eef6;min-height:100vh;padding:28px}
    .container{max-width:1100px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#7c3aed);display:flex;justify-content:center;align-items:center;font-weight:700}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:380px 1fr;gap:20px}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
    input[type=text],input[type=number],select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .row{display:flex;gap:10px}
    .btn{display:inline-block;padding:10px 12px;border-radius:10px;background:linear-gradient(90deg,var(--accent),#7c3aed);border:none;color:#021022;font-weight:600;cursor:pointer}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .small{font-size:13px}
    .schedule{margin-top:12px}
    .day{padding:10px;border-radius:8px;background:var(--glass);margin-bottom:8px}
    ul{margin:6px 0 0 18px}
    .flex-between{display:flex;justify-content:space-between;align-items:center}
    .chart-wrap{display:flex;gap:18px;align-items:flex-start}
    .chart-card{flex:1}
    .progress-list{max-height:220px;overflow:auto;margin-top:8px}
    .entry{padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);margin-bottom:8px}
    footer{margin-top:18px;color:var(--muted);font-size:13px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}.logo{display:none}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">KHAN</div>
      <div>
        <h1>Your own AI Fitness Club</h1>
        <p class="lead">Train like a beastü¶Å,look like a beautyüòç</p>
      </div>
    </header>

    <div class="grid">
      <div>
        <div class="card">
          <h3 style="margin-top:0">Tell me about you</h3>
          <div style="margin-top:8px">
            <label>Weight (kg)</label>
            <input id="weight" type="number" min="20" max="300" value="75">
          </div>

          <div style="margin-top:10px">
            <label>Goal</label>
            <select id="goal">
              <option value="lose">Lose weight / Fat loss</option>
              <option value="build">Build muscle / Strength</option>
              <option value="maintain">Maintain / General fitness</option>
            </select>
          </div>

          <div style="margin-top:10px">
            <label>Available time per workout (minutes)</label>
            <select id="minutes">
              <option value="15">15</option>
              <option value="20">20</option>
              <option value="30" selected>30</option>
              <option value="45">45</option>
              <option value="60">60</option>
            </select>
          </div>

          <div style="margin-top:10px">
            <label>Equipment (comma-separated)</label>
            <input id="equipment" type="text" placeholder="e.g. dumbbells, resistance band, none" value="dumbbells">
            <div class="small" style="margin-top:6px;color:var(--muted)">Tip: write 'none' if you have no equipment.</div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px">
            <button id="generate" class="btn">Generate Weekly Plan</button>
            <button id="saveProfile" class="ghost">Save Profile</button>
            <button id="clear" class="ghost">Clear Data</button>
          </div>

          <div style="margin-top:12px"><strong>Profile</strong>
            <div id="profileSummary" class="small" style="margin-top:6px;color:var(--muted)">No saved profile.</div>
          </div>

        </div>

        <div class="card" style="margin-top:12px">
          <div class="flex-between"><h3 style="margin:0">Progress & Log</h3>
            <div>
              <button id="addEntry" class="ghost">+ Add Entry</button>
            </div>
          </div>

          <div class="progress-list" id="progressList">
            <!-- entries appended here -->
          </div>

        </div>

      </div>

      <div>
        <div class="card">
          <div class="flex-between">
            <h3 style="margin:0">Weekly Plan</h3>
            <div style="display:flex;gap:8px">
              <button id="copyPlan" class="ghost">Copy</button>
              <button id="downloadPlan" class="ghost">Download</button>
            </div>
          </div>

          <div id="schedule" class="schedule" style="min-height:120px">
            <div class="small" style="color:var(--muted);margin-top:8px">No plan generated yet. Click <strong>Generate Weekly Plan</strong>.</div>
          </div>
        </div>

        <div class="card chart-wrap" style="margin-top:12px;gap:12px">
          <div class="chart-card">
            <h4 style="margin-top:0">Weight Over Time</h4>
            <canvas id="weightChart" height="140"></canvas>
          </div>
          <div style="width:280px">
            <h4 style="margin-top:0">Week Summary</h4>
            <div id="weekSummary" class="small" style="color:var(--muted);line-height:1.6">
              No summary yet.
            </div>
            <div style="margin-top:10px">
              <button id="markDone" class="btn small">Mark Today's Workout Done</button>
            </div>
          </div>
        </div>

        <footer>
          Built as a single HTML file. Data is stored locally in your browser (localStorage).
        </footer>
      </div>
    </div>
  </div>

  <!-- Modal for adding progress -->
  <div id="modal" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:40">
    <div style="width:420px;background:var(--card);padding:16px;border-radius:12px">
      <h3 style="margin-top:0">Add Progress Entry</h3>
      <label>Date</label>
      <input id="entryDate" type="date" style="margin-bottom:8px">
      <label>Weight (kg)</label>
      <input id="entryWeight" type="number" min="20" max="300" style="margin-bottom:8px">
      <label>Notes</label>
      <textarea id="entryNotes" rows="3" style="margin-bottom:10px"></textarea>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button id="closeModal" class="ghost">Cancel</button>
        <button id="saveEntry" class="btn">Save</button>
      </div>
    </div>
  </div>

  <script>
    /* ---------- Utilities ---------- */
    const $ = id=>document.getElementById(id);

    function uid(){return Date.now().toString(36) + Math.random().toString(36).slice(2,8)}

    /* ---------- Storage ---------- */
    const STORAGE_KEY = 'fp_app_v1';
    function loadState(){
      try{const s=localStorage.getItem(STORAGE_KEY);return s?JSON.parse(s):{profile:null,plan:null,progress:[]};}catch(e){return {profile:null,plan:null,progress:[]};}
    }
    function saveState(state){localStorage.setItem(STORAGE_KEY,JSON.stringify(state));}

    let state = loadState();

    /* ---------- Profile actions ---------- */
    function saveProfileFromForm(){
      const profile = {
        weight: Number($('weight').value)||75,
        goal: $('goal').value,
        minutes: Number($('minutes').value)||30,
        equipment: $('equipment').value.split(',').map(s=>s.trim()).filter(Boolean)
      };
      state.profile = profile;
      saveState(state);
      renderProfile();
      toast('Profile saved locally');
    }

    function renderProfile(){
      if(!state.profile){ $('profileSummary').innerText='No saved profile.'; return; }
      const p = state.profile;
      $('profileSummary').innerHTML = `Weight: ${p.weight} kg ¬∑ Goal: ${capitalize(p.goal)} ¬∑ Time: ${p.minutes} min ¬∑ Equipment: ${p.equipment.join(', ') || 'none'}`;
    }

    function capitalize(s){return s.charAt(0).toUpperCase()+s.slice(1)}

    /* ---------- Plan generation (AI-like algorithm) ---------- */
    const EXERCISES = {
      bodyweight: [
        {name:'Push-ups',type:'strength'},
        {name:'Squats',type:'strength'},
        {name:'Lunges',type:'strength'},
        {name:'Plank',type:'core'},
        {name:'Burpees',type:'cardio'},
        {name:'Glute bridges',type:'strength'},
        {name:'Mountain climbers',type:'cardio'}
      ],
      dumbbells: [
        {name:'Dumbbell Goblet Squat',type:'strength'},
        {name:'Dumbbell Row',type:'strength'},
        {name:'Dumbbell Shoulder Press',type:'strength'},
        {name:'Dumbbell Deadlift',type:'strength'},
        {name:'Dumbbell Swing',type:'cardio'}
      ],
      band: [
        {name:'Band Pull Aparts',type:'mobility'},
        {name:'Band Deadlifts',type:'strength'},
        {name:'Band Squats',type:'strength'}
      ]
    };

    function chooseExercises(equipment){
      const set = new Set();
      set.add(...EXERCISES.bodyweight);
      const eq = equipment.map(e=>e.toLowerCase());
      if(eq.includes('dumbbell') || eq.includes('dumbbells')) EXERCISES.dumbbells.forEach(x=>set.add(x));
      if(eq.includes('resistance')||eq.includes('band')) EXERCISES.band.forEach(x=>set.add(x));
      // convert back to array
      return Array.from(set);
    }

    function generatePlan(profile){
      // basic algorithmic 'AI' that assembles a balanced 7-day plan
      const exercises = chooseExercises(profile.equipment || []);
      const minutes = profile.minutes || 30;
      const goal = profile.goal || 'maintain';

      const week = [];
      const cardioIntensity = goal==='lose' ? 'Higher' : goal==='build' ? 'Moderate' : 'Moderate';

      for(let d=0;d<7;d++){
        const day = {dayIndex:d,name:weekdayName(d),items:[]};
        // rest every 7th day (Sunday) if short time
        if(minutes<=20 && d%6===0){ day.items.push({name:'Active Recovery / Stretching',notes:'20-minute mobility and walking',time:20}); week.push(day); continue; }

        // simple split: 3 strength days, 2 cardio, 1 hybrid, 1 active recovery
        let type;
        if(d%6===0) type='recovery';
        else if(d%3===0) type='cardio';
        else if(d%2===0) type='strength';
        else type='hybrid';

        if(type==='recovery'){
          day.items.push({name:'Active Recovery','notes':'Mobility, foam-roll, light walk',time:Math.min(30,minutes)});
        } else if(type==='cardio'){
          day.items.push({name: cardioIntensity+' Cardio Circuit',notes:`${minutes} min circuit: jumping jacks, mountain climbers, burpees (modify as needed)`,time:minutes});
        } else if(type==='strength'){
          // pick 4 exercises
          const pool = exercises.filter(e=>e.type==='strength' || e.type==='core');
          shuffle(pool);
          const picked = pool.slice(0,4);
          picked.forEach(ex=>day.items.push({name:ex.name,notes:'3 sets ‚Äî reps: '+(goal==='build'? '8-12' : '10-15'),time:Math.round(minutes / 4)}));
        } else {
          // hybrid
          const pool = exercises.slice(); shuffle(pool);
          const pick = pool.slice(0,3);
          pick.forEach(ex=>day.items.push({name:ex.name,notes:'2-3 sets, combo style',time:Math.round(minutes / 3)}));
          day.items.push({name:'Core finisher',notes:'Plank & Side Plank variations ‚Äî 5 minutes',time:5});
        }
        week.push(day);
      }

      return {generatedAt:new Date().toISOString(),profileSnapshot:profile,week};
    }

    function weekdayName(offset){
      const base = new Date();
      base.setDate(base.getDate() + offset);
      return base.toLocaleDateString(undefined,{weekday:'long'});
    }

    function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } }

    /* ---------- Rendering plan ---------- */
    function renderPlan(){
      const target = $('schedule');
      target.innerHTML = '';
      if(!state.plan){ target.innerHTML = '<div class="small" style="color:var(--muted)">No plan generated yet. Click <strong>Generate Weekly Plan</strong>.</div>'; return; }
      const week = state.plan.week;
      week.forEach(day=>{
        const div = document.createElement('div'); div.className='day';
        const header = document.createElement('div'); header.className='flex-between';
        const h = document.createElement('strong'); h.innerText = day.name;
        const t = document.createElement('span'); t.className='small'; t.style.color='var(--muted)'; t.innerText = day.items.map(it=>it.time).reduce((a,b)=>a+b,0)+' min';
        header.appendChild(h); header.appendChild(t);
        div.appendChild(header);
        day.items.forEach(it=>{
          const ul = document.createElement('ul');
          const li = document.createElement('li'); li.innerHTML = `<strong>${it.name}</strong> ‚Äî <span class='small' style='color:var(--muted)'>${it.notes} (${it.time} min)</span>`;
          ul.appendChild(li); div.appendChild(ul);
        });
        target.appendChild(div);
      });
    }

    /* ---------- Progress logging & chart ---------- */
    function renderProgress(){
      const list = $('progressList'); list.innerHTML='';
      if(!state.progress || state.progress.length===0){ list.innerHTML='<div class="small" style="color:var(--muted)">No progress entries yet. Click + Add Entry.</div>'; return; }
      state.progress.slice().reverse().forEach(entry=>{
        const div = document.createElement('div'); div.className='entry';
        div.innerHTML = `<div style="display:flex;justify-content:space-between"><div><strong>${entry.date}</strong><div class='small' style='color:var(--muted)'>${entry.notes||''}</div></div><div><strong>${entry.weight?entry.weight+' kg':''}</strong><div style='margin-top:6px'><button data-id='${entry.id}' class='ghost small'>Edit</button> <button data-id-del='${entry.id}' class='ghost small'>Delete</button></div></div></div>`;
        list.appendChild(div);
      });

      // attach handlers
      list.querySelectorAll('[data-id]').forEach(btn=>btn.addEventListener('click',e=>editEntry(e.target.dataset.id)));
      list.querySelectorAll('[data-id-del]').forEach(btn=>btn.addEventListener('click',e=>deleteEntry(e.target.dataset.idDel)));

      updateCharts();
    }

    function addEntry(entry){ state.progress.push(entry); saveState(state); renderProgress(); toast('Entry saved'); }
    function editEntry(id){ const e = state.progress.find(x=>x.id===id); if(!e) return; $('entryDate').value=e.date; $('entryWeight').value=e.weight||''; $('entryNotes').value=e.notes||''; showModal(); // on save will overwrite newest or create new -- simple UX
      editingId = id; }
    function deleteEntry(id){ state.progress = state.progress.filter(x=>x.id!==id); saveState(state); renderProgress(); }

    let editingId = null;

    function updateCharts(){
      const ctx = document.getElementById('weightChart').getContext('2d');
      const entries = state.progress.slice().sort((a,b)=>new Date(a.date)-new Date(b.date));
      const labels = entries.map(e=>e.date);
      const data = entries.map(e=>Number(e.weight)||null);
      if(window._weightChart) window._weightChart.destroy();
      window._weightChart = new Chart(ctx,{
        type:'line',data:{labels, datasets:[{label:'Weight (kg)',data,fill:false,tension:0.2}]},options:{scales:{y:{beginAtZero:false}},plugins:{legend:{display:false}}}
      });

      // update week summary
      if(state.plan){
        const total = state.plan.week.reduce((s,d)=>s + d.items.reduce((a,b)=>a + (b.time||0),0),0);
        $('weekSummary').innerHTML = `Plan generated on: <strong>${new Date(state.plan.generatedAt).toLocaleString()}</strong><br>Total planned minutes this week: <strong>${total} min</strong><br>Profile snapshot: <span style='color:var(--muted)'>${state.plan.profileSnapshot.weight}kg ¬∑ ${state.plan.profileSnapshot.goal} ¬∑ ${state.plan.profileSnapshot.minutes}min</span>`;
      }
    }

    /* ---------- Helpers: copy/download/toast/modal ---------- */
    function copyToClipboard(text){navigator.clipboard.writeText(text).then(()=>toast('Copied to clipboard'))}
    function download(filename, text){const a=document.createElement('a'); a.href='data:text/plain;charset=utf-8,'+encodeURIComponent(text); a.download=filename; a.click();}

    function toast(msg){
      const t = document.createElement('div'); t.innerText=msg; t.style.position='fixed'; t.style.right='18px'; t.style.bottom='18px'; t.style.background='linear-gradient(90deg,var(--accent),#7c3aed)'; t.style.color='#021022'; t.style.padding='10px 12px'; t.style.borderRadius='10px'; t.style.zIndex=9999; document.body.appendChild(t);
      setTimeout(()=>{t.style.opacity=0; setTimeout(()=>t.remove(),400)},1700);
    }

    function showModal(){ $('modal').style.display='flex'; }
    function closeModal(){ editingId=null; $('modal').style.display='none'; $('entryDate').value=''; $('entryWeight').value=''; $('entryNotes').value=''; }

    /* ---------- Event wiring ---------- */
    document.getElementById('generate').addEventListener('click',()=>{
      const profile = {
        weight: Number($('weight').value)||75,
        goal: $('goal').value,
        minutes: Number($('minutes').value)||30,
        equipment: $('equipment').value.split(',').map(s=>s.trim()).filter(Boolean)
      };
      state.plan = generatePlan(profile);
      saveState(state);
      renderPlan();
      renderProgress();
      toast('Weekly plan generated');
    });

    $('saveProfile').addEventListener('click',saveProfileFromForm);
    $('clear').addEventListener('click',()=>{ if(confirm('Clear all saved data (profile, plan, progress)?')){ state={profile:null,plan:null,progress:[]}; saveState(state); renderAll(); toast('Cleared'); } });

    $('addEntry').addEventListener('click',()=>{ showModal(); });
    $('closeModal').addEventListener('click',()=>closeModal());
    $('saveEntry').addEventListener('click',()=>{
      const date = $('entryDate').value || new Date().toISOString().slice(0,10);
      const weight = $('entryWeight').value? Number($('entryWeight').value):null;
      const notes = $('entryNotes').value||'';
      if(editingId){ const idx = state.progress.findIndex(x=>x.id===editingId); if(idx>-1){ state.progress[idx]={...state.progress[idx],date,weight,notes}; saveState(state); renderProgress(); closeModal(); editingId=null; toast('Entry updated'); return; } }
      const entry = {id:uid(),date,weight,notes}; addEntry(entry); closeModal();
    });

    $('copyPlan').addEventListener('click',()=>{
      if(!state.plan){ toast('No plan to copy'); return; }
      copyToClipboard(JSON.stringify(state.plan, null, 2));
    });

    $('downloadPlan').addEventListener('click',()=>{
      if(!state.plan){ toast('No plan to download'); return; }
      download('weekly_plan.json', JSON.stringify(state.plan, null, 2));
    });

    $('markDone').addEventListener('click',()=>{
      const today = new Date().toISOString().slice(0,10);
      const note = 'Marked workout done from app';
      const entry = {id:uid(),date:today,weight: null,notes:note};
      state.progress.push(entry); saveState(state); renderProgress(); toast(`Marked ${today} done`);
    });

    /* ---------- Init ---------- */
    function renderAll(){ renderProfile(); renderPlan(); renderProgress(); }

    // load existing
    if(state.profile){ // populate form
      $('weight').value = state.profile.weight||75;
      $('goal').value = state.profile.goal||'maintain';
      $('minutes').value = state.profile.minutes||30;
      $('equipment').value = (state.profile.equipment || []).join(', ');
    }
    renderAll();

  </script>
</body>
</html>
